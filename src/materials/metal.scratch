(macro (v3-reflect vec normal)
       (v3- ,vec (v3-scale (* 2 (v3-dot ,vec ,normal)) ,normal)))

(sprite "main"
  (proc (scatter-metal ray.dx ray.dy ray.dz albedo.r albedo.g albedo.b)
    (v3-store scattered.r scattered.g scattered.b
              (Vec3 albedo.r albedo.g albedo.b))
    (v3-store scattered.dx scattered.dy scattered.dz
              (v3-reflect ray.dir hit.normal))))
